(function(e){e.spModalEventable=function(e){this._target=e},e.spModalEventable.prototype._target=null,e.spModalEventable.prototype.getTarget=function(){return this._target},e.spModalEventable.prototype.on=function(){var e=Array.prototype.slice.call(arguments);return this._target.on.apply(this._target,e)},e.spModalEventable.prototype.off=function(){var e=Array.prototype.slice.call(arguments);return this._target.off.apply(this._target,e)},e.spModalEventable.prototype.trigger=function(e){var t=Array.prototype.slice.call(arguments);this._target.trigger.apply(this._target,t)}})(jQuery),function(e){e.spModalWindow=function(t,n){var r=this;n===undefined&&(n={});var i=new e.spModalLoading;i.addButton("Cancel",function(){r._target!==null&&r._target.remove(),i.close()}),this._target=e('<iframe class="sp-modal-window" />').css("visibility","hidden").attr("src",t).data(n).load(function(){r._target.css("visibility","visible"),i.close()}).appendTo("body"),e.spModalEventable.call(this,this._target)},e.spModalWindow.prototype=Object.create(e.spModalEventable.prototype),e.spModalWindow.prototype.close=function(){this._target.remove()}}(jQuery),function(e){e.spModalUi=function(t,n){this._target=t,this._modalWindow=n===undefined?this._searchModalWindow():n,e.ui!==undefined&&this._target.draggable({handle:".sp-modal-draggable"}),this._update(),e.spModalEventable.call(this,this._target)},e.spModalUi.prototype=Object.create(e.spModalEventable.prototype),e.spModalUi.prototype._modalWindow=null,e.spModalUi.prototype._target=null,e.spModalUi.prototype._x=null,e.spModalUi.prototype._y=null,e.spModalUi.prototype.getModalWindow=function(){return this._modalWindow},e.spModalUi.prototype.getTarget=function(){return this._target},e.spModalUi.prototype.getParam=function(e){return this._modalWindow.data(e)},e.spModalUi.prototype.getX=function(){return this._x},e.spModalUi.prototype.setX=function(e){this._x=e,this._update()},e.spModalUi.prototype.getY=function(){return this._y},e.spModalUi.prototype.setY=function(e){this._y=e,this._update()},e.spModalUi.prototype.off=function(){var t=Array.prototype.slice.call(arguments);return e(document).has(this._modalWindow).length==0&&this._modalWindow.off.apply(this._modalWindow,t),this._target.off.apply(this._target,t)},e.spModalUi.prototype.trigger=function(t){var n=this,r=Array.prototype.slice.call(arguments);e(document).has(this._modalWindow).length==0&&this._target.one(t,function(){n._modalWindow.trigger.apply(n._modalWindow,r)}),this._target.trigger.apply(this._target,r)},e.spModalUi.prototype.close=function(){this._modalWindow.remove()},e.spModalUi.prototype._searchModalWindow=function(){var t=e(window);return window.parent.$("iframe").each(function(){if(this.contentWindow===window)return t=window.parent.$(this),!1}),t},e.spModalUi.prototype._update=function(){var t=this.getX()===null?Math.max(0,e(window).width()/2-this._target.width()/2):this.getX(),n=this.getY()===null?Math.max(0,e(window).height()/5-this._target.height()/2):this.getY();this._target.css({left:t,top:n})}}(jQuery),function(e){e.spModalDialog=function(t,n){e.spModalUi.call(this,t,n)},e.spModalDialog.prototype=Object.create(e.spModalUi.prototype),e.spModalDialog.prototype.addButton=function(t,n){var r=this.getTarget(),i=e(".sp-modal-footer",r),s=e('<input type="button" />').val(t).appendTo(i);return n!==undefined&&s.on("click",e.proxy(n,this)),s}}(jQuery),function(e){e.spModalLoading=function(t){t===undefined&&(t="Please wait...");var n=e('<div class="sp-modal-ui sp-modal-loading"><div class="sp-modal-icon"></div><div class="sp-modal-text"></div><div class="sp-modal-footer"></div></div>');e(".sp-modal-text",n).text(t);var r=e('<div class="sp-modal-window" />');r.appendTo("body"),r.append(n),e.spModalDialog.call(this,n,r)},e.spModalLoading.prototype=Object.create(e.spModalDialog.prototype)}(jQuery),function(e){e.spModalMessage=function(t,n){var r=e('<div class="sp-modal-ui sp-modal-message"><div class="sp-modal-header sp-modal-draggable"></div><div class="sp-modal-body"><div class="sp-modal-text"></div></div><div class="sp-modal-footer"></div></div>');e(".sp-modal-header",r).text(t),e(".sp-modal-text",r).text(n);var i=e('<div class="sp-modal-window" />');i.appendTo("body"),i.append(r),e.spModalDialog.call(this,r,i)},e.spModalMessage.prototype=Object.create(e.spModalDialog.prototype),e.spModalMessage.prototype._availTextAlign=["left","right","center","justify","initial","inherit"],e.spModalMessage.prototype._textAlign="center",e.spModalMessage.prototype.getText=function(){var t=this.getTarget();return e(".sp-modal-text",t).text()},e.spModalMessage.prototype.setText=function(t){var n=this.getTarget();e(".sp-modal-text",n).text(t)},e.spModalMessage.prototype.getHtmlText=function(){var t=this.getTarget();return e(".sp-modal-text",t).html()},e.spModalMessage.prototype.setHtmlText=function(t){var n=this.getTarget();e(".sp-modal-text",n).html(t)},e.spModalMessage.prototype.getTextAlign=function(){return this._textAlign},e.spModalMessage.prototype.setTextAlign=function(t){e.inArray(t,this._availTextAlign)<0&&e.error("Invalid alignment. Valid alignments are: "+this._availTextAlign.join(", ")),this._textAlign=t,this._update()},e.spModalMessage.prototype._update=function(){var t=this.getTarget();e(".sp-modal-text",t).css("text-align",this._textAlign),e.spModalDialog.prototype._update.call(this)}}(jQuery),function(e){var t={window:function(t,n){return new e.spModalWindow(t,n)},ui:function(t,n){return new e.spModalUi(t,n)},message:function(t,n){return new e.spModalMessage(t,n)},loading:function(t){return new e.spModalLoading(t)}};e.spModal=function(n,r){var i=t[n],r=Array.prototype.slice.call(arguments,1);return i===undefined&&e.error("Method not found: "+n),i.apply(this,r)}}(jQuery);