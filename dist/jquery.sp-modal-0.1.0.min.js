/*! jQuery.spModal v0.1.0 | Copyright (c) 2015 Gonzalo Chumillas | https://github.com/soloproyectos/jquery.modal/blob/master/LICENSE */
!function(t){t.spModalEventable=function(t){this._target=t},t.spModalEventable.prototype._target=null,t.spModalEventable.prototype.getTarget=function(){return this._target},t.spModalEventable.prototype.on=function(){var t=Array.prototype.slice.call(arguments);return this._target.on.apply(this._target,t)},t.spModalEventable.prototype.off=function(){var t=Array.prototype.slice.call(arguments);return this._target.off.apply(this._target,t)},t.spModalEventable.prototype.trigger=function(t){var e=Array.prototype.slice.call(arguments);this._target.trigger.apply(this._target,e)}}(jQuery),function(t){t.spModalWindow=function(e,o){var a=this;void 0===o&&(o={});var s=new t.spModalLoading;s.addButton("Cancel",function(){null!==a._target&&a._target.remove(),s.close()}),this._target=t('<iframe class="sp-modal-window" />').css("visibility","hidden").attr("src",e).data(o).load(function(){a._target.css("visibility","visible"),s.close()}).appendTo("body"),t.spModalEventable.call(this,this._target)},t.spModalWindow.prototype=Object.create(t.spModalEventable.prototype),t.spModalWindow.prototype.close=function(){this._target.remove()}}(jQuery),function(t){t.spModalUi=function(e,o){this._target="string"==t.type(e)?t(e):e,this._modalWindow=void 0===o?this._searchModalWindow():o,void 0===t.ui&&t.error("jQuery.ui >= 1.11.4 is required"),this._target.draggable({handle:".sp-modal-draggable"}),this.update(),t.spModalEventable.call(this,this._target)},t.spModalUi.prototype=Object.create(t.spModalEventable.prototype),t.spModalUi.prototype._modalWindow=null,t.spModalUi.prototype._target=null,t.spModalUi.prototype._x=null,t.spModalUi.prototype._y=null,t.spModalUi.prototype.getModalWindow=function(){return this._modalWindow},t.spModalUi.prototype.getTarget=function(){return this._target},t.spModalUi.prototype.getParam=function(t){return this._modalWindow.data(t)},t.spModalUi.prototype.getX=function(){return this._x},t.spModalUi.prototype.setX=function(t){this._x=t,this.update()},t.spModalUi.prototype.getY=function(){return this._y},t.spModalUi.prototype.setY=function(t){this._y=t,this.update()},t.spModalUi.prototype.off=function(){var e=Array.prototype.slice.call(arguments);return 0==t(document).has(this._modalWindow).length&&this._modalWindow.off.apply(this._modalWindow,e),this._target.off.apply(this._target,e)},t.spModalUi.prototype.trigger=function(e){var o=this,a=Array.prototype.slice.call(arguments);0==t(document).has(this._modalWindow).length&&this._target.one(e,function(){o._modalWindow.trigger.apply(o._modalWindow,a)}),this._target.trigger.apply(this._target,a)},t.spModalUi.prototype.close=function(){this._modalWindow.remove()},t.spModalUi.prototype.update=function(){var e=null===this.getX()?Math.max(0,t(window).width()/2-this._target.width()/2):this.getX(),o=null===this.getY()?Math.max(0,t(window).height()/5-this._target.height()/2):this.getY();this._target.css({left:e,top:o})},t.spModalUi.prototype._searchModalWindow=function(){var e=t(window);return window.parent.$("iframe").each(function(){return this.contentWindow===window?(e=window.parent.$(this),!1):void 0}),e}}(jQuery),function(t){t.spModalDialog=function(e,o){t.spModalUi.call(this,e,o)},t.spModalDialog.prototype=Object.create(t.spModalUi.prototype),t.spModalDialog.prototype.addButton=function(e,o){var a=this.getTarget(),s=t(".sp-modal-footer",a),r=t('<input type="button" />').val(e).appendTo(s).focus();return void 0!==o&&r.on("click",t.proxy(o,this)),r}}(jQuery),function(t){t.spModalLoading=function(e){void 0===e&&(e="Please wait...");var o=t('<div class="sp-modal-ui sp-modal-loading"><div class="sp-modal-icon"></div><div class="sp-modal-text"></div><div class="sp-modal-footer"></div></div>');t(".sp-modal-text",o).text(e);var a=t('<div class="sp-modal-window" />');a.appendTo("body"),a.append(o),t.spModalDialog.call(this,o,a)},t.spModalLoading.prototype=Object.create(t.spModalDialog.prototype)}(jQuery),function(t){t.spModalProgress=function(e,o){void 0===o&&(o="Please wait...");var a=t('<div class="sp-modal-ui sp-modal-message sp-modal-progress"><div class="sp-modal-header sp-modal-draggable"></div><div class="sp-modal-body"><div class="sp-modal-text"></div><div class="sp-modal-progress-bar"><div class="sp-modal-indicator">&nbsp;</div><div class="sp-modal-percent">0%</div></div></div><div class="sp-modal-footer"></div></div>');t(".sp-modal-header",a).text(e),t(".sp-modal-text",a).text(o);var s=t('<div class="sp-modal-window" />');s.appendTo("body"),s.append(a),t.spModalDialog.call(this,a,s)},t.spModalProgress.prototype=Object.create(t.spModalDialog.prototype),t.spModalProgress.prototype._value=0,t.spModalProgress.prototype.getValue=function(){return this._value},t.spModalProgress.prototype.setValue=function(t){this._value=Math.max(0,Math.min(t,1)),this.update()},t.spModalProgress.prototype.update=function(){var e=this.getTarget(),o=100*this._value;t(".sp-modal-indicator",e).css("width",o+"%"),t(".sp-modal-percent",e).text(Math.floor(o)+"%"),t.spModalDialog.prototype.update.call(this)}}(jQuery),function(t){t.spModalMessage=function(e,o){var a=t('<div class="sp-modal-ui sp-modal-message"><div class="sp-modal-header sp-modal-draggable"></div><div class="sp-modal-body"><div class="sp-modal-text"></div></div><div class="sp-modal-footer"></div></div>');t(".sp-modal-header",a).text(e),t(".sp-modal-text",a).text(o);var s=t('<div class="sp-modal-window" />');s.appendTo("body"),s.append(a),t.spModalDialog.call(this,a,s)},t.spModalMessage.prototype=Object.create(t.spModalDialog.prototype),t.spModalMessage.prototype._availTextAlign=["left","right","center","justify","initial","inherit"],t.spModalMessage.prototype._textAlign="center",t.spModalMessage.prototype.getText=function(){var e=this.getTarget();return t(".sp-modal-text",e).text()},t.spModalMessage.prototype.setText=function(e){var o=this.getTarget();t(".sp-modal-text",o).text(e)},t.spModalMessage.prototype.getHtmlText=function(){var e=this.getTarget();return t(".sp-modal-text",e).html()},t.spModalMessage.prototype.setHtmlText=function(e){var o=this.getTarget();t(".sp-modal-text",o).html(e)},t.spModalMessage.prototype.getTextAlign=function(){return this._textAlign},t.spModalMessage.prototype.setTextAlign=function(e){t.inArray(e,this._availTextAlign)<0&&t.error("Invalid alignment. Valid alignments are: "+this._availTextAlign.join(", ")),this._textAlign=e,this.update()},t.spModalMessage.prototype.update=function(){var e=this.getTarget();t(".sp-modal-text",e).css("text-align",this._textAlign),t.spModalDialog.prototype.update.call(this)}}(jQuery),function(t){t.spModalRequest=function(e,o){t.inArray(e,["get","post"])<0&&t.error("Method not allowed: "+e),this._method=e,this._args=Array.prototype.slice.call(arguments,1)},t.spModalRequest.prototype._method=null,t.spModalRequest.prototype._args=[],t.spModalRequest.prototype.send=function(){var e=new t.Deferred,o=null,a=new t.spModalLoading;return a.addButton("Cancel",function(){null!=o&&o.abort()}),o=t[this._method].apply(this,this._args).always(function(){a.close()}).done(function(t,o,a){e.resolve(t,o,a)}).fail(function(o,a){var s="string"==t.type(o.responseText)&&o.responseText.length>0?o.responseText:"The request has failed",r="string"==t.type(o.statusText)&&o.statusText.length>0?o.statusText:"HTTP Request Error";"parsererror"==a&&(r="The document is not well formed");var i=new t.spModalMessage(r,s);i.setTextAlign("left"),i.addButton("Ok",function(){i.close(),e.reject(o,a)}),t.error(s)}),e.promise()}}(jQuery),function(t){t.spModalRequestGet=function(e){var o=Array.prototype.slice.call(arguments);o.unshift("get"),t.spModalRequest.apply(this,o)},t.spModalRequestGet.prototype=Object.create(t.spModalRequest.prototype)}(jQuery),function(t){t.spModalRequestPost=function(e){var o=Array.prototype.slice.call(arguments);o.unshift("post"),t.spModalRequest.apply(this,o)},t.spModalRequestPost.prototype=Object.create(t.spModalRequest.prototype)}(jQuery),function(t){t.spModalRequestUpload=function(e,o,a){this._input="string"==t.type(e)?t(e):e,this._url=o,this._data=a},t.spModalRequestUpload.prototype._input=null,t.spModalRequestUpload.prototype._url="",t.spModalRequestUpload.prototype._data={},t.spModalRequestUpload.prototype.send=function(){var e=new t.Deferred,o=new FormData,a=null;this._input.each(function(){var e=t(this),a=e.attr("name"),s=this.files[0];("string"!=t.type(a)||0==a.length)&&t.error('Attribute "name" is required for the input file'),void 0!==s&&o.append(a,s)}),void 0!==this._data&&t.each(this._data,function(t,e){o.append(t,e)});var s=new t.spModalProgress("Uploading file...");s.addButton("Cancel Upload",function(){s.close(),null!=a&&a.abort()});var a=new XMLHttpRequest;return a.upload.addEventListener("progress",function(e){var o="number"==t.type(e.total)?e.total:100,a="number"==t.type(e.loaded)?e.loaded:0;s.setValue(a/o)},!1),a.addEventListener("readystatechange",function(){if(4==a.readyState){s.close();var o=""+a.status;if(!o.match(/^2\d{2}$/)){var r="string"==t.type(a.responseText)&&a.responseText.length>0?a.responseText:"The request has failed",i="string"==t.type(a.statusText)&&a.statusText.length>0?a.statusText:"HTTP Request Error",p=new t.spModalMessage(i,r);p.setTextAlign("left"),p.addButton("Ok",function(){p.close(),e.reject(a,o)}),t.error(r)}e.resolve(a.responseText,"sucess",a)}},!1),a.open("POST",this._url,!0),a.send(o),e.promise()}}(jQuery),function(t){var e={window:function(e,o){return new t.spModalWindow(e,o)},ui:function(e,o){return new t.spModalUi(e,o)},message:function(e,o){return new t.spModalMessage(e,o)},loading:function(e){return new t.spModalLoading(e)},get:function(e){function o(e){return t.spModalRequestGet.apply(this,e)}o.prototype=t.spModalRequestGet.prototype;var a=new o(arguments);return a.send()},post:function(e){function o(e){return t.spModalRequestPost.apply(this,e)}o.prototype=t.spModalRequestPost.prototype;var a=new o(arguments);return a.send()},upload:function(e,o,a){var s=new t.spModalRequestUpload(e,o,a);return s.send()}};t.spModal=function(o,a){var s=e[o],a=Array.prototype.slice.call(arguments,1);return void 0===s&&t.error("Method not found: "+o),s.apply(this,a)}}(jQuery);